{"ast":null,"code":"import jsPDF from 'jspdf';\nimport html2canvas from 'html2canvas';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"src/app/services/reservations.service\";\nimport * as i2 from \"src/app/services/events.service\";\n\nfunction ClientInvoiceComponent_tr_27_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"tr\", 16)(1, \"td\");\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"td\");\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd()();\n  }\n\n  if (rf & 2) {\n    const e_r1 = ctx.$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\" \", e_r1.Event.name, \" \");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\" \", e_r1.total, \" \");\n  }\n}\n\nexport let ClientInvoiceComponent = /*#__PURE__*/(() => {\n  class ClientInvoiceComponent {\n    constructor(reservationService, eventsService) {\n      this.reservationService = reservationService;\n      this.eventsService = eventsService;\n      this.title = 'pdf-viewer';\n      this.reservations = [];\n      this.reserve = [];\n      this.events = [];\n      this.reserved = [];\n      this.totale = 0;\n      this.today = new Date();\n      this.price = {};\n    }\n\n    ngOnInit() {\n      this.userConnect = JSON.parse(localStorage.getItem(\"userConnect\") || \"[]\");\n      this.reservationService.getReservations().subscribe(data => {\n        console.log(data.reserved_events);\n        this.reservations = data.reserved_events;\n        console.log(this.reservations);\n\n        for (let i = 0; i < this.reservations.length; i++) {\n          if (this.reservations[i].idUser == this.userConnect._id) this.reserve.push(this.reservations[i]);\n        }\n\n        console.log(this.reserve);\n\n        for (let i = 0; i < this.reserve.length; i++) {\n          this.eventsService.getEvent(this.reserve[i].idEvent).subscribe(data => {\n            this.events = data.event;\n            console.log(this.events);\n            this.reserved.push({\n              Event: this.events,\n              total: [this.reserve[i].totalePrice]\n            });\n            this.totale = this.totale + parseInt(this.reserve[i].totalePrice);\n          });\n        }\n\n        console.log(this.reserved);\n      });\n    }\n\n    DownloadPDF() {\n      this.data = document.getElementById('invoice');\n      html2canvas(this.data).then(canvas => {\n        var imgWidth = 210;\n        var imgHeight = canvas.height * imgWidth / canvas.width;\n        const contentDataURL = canvas.toDataURL('image/png');\n        const doc = new jsPDF();\n        var position = 0;\n        doc.addImage(contentDataURL, 'PNG', 0, position, imgWidth, imgHeight);\n        doc.save('invoice.pdf');\n      });\n    }\n\n  }\n\n  ClientInvoiceComponent.ɵfac = function ClientInvoiceComponent_Factory(t) {\n    return new (t || ClientInvoiceComponent)(i0.ɵɵdirectiveInject(i1.ReservationsService), i0.ɵɵdirectiveInject(i2.EventsService));\n  };\n\n  ClientInvoiceComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: ClientInvoiceComponent,\n    selectors: [[\"app-client-invoice\"]],\n    decls: 39,\n    vars: 6,\n    consts: [[1, \"container\", 2, \"background-color\", \"#222\"], [1, \"row\"], [1, \"col-lg-12\", \"text-center\", \"mb100\"], [\"id\", \"invoice\", 1, \"invoice-box\", 2, \"background-color\", \"rgb(255, 255, 255)\"], [\"cellpadding\", \"0\", \"cellspacing\", \"0\"], [1, \"top\"], [\"colspan\", \"2\"], [1, \"title\"], [\"src\", \"assets/img/logo.png\", 2, \"width\", \"60%\", \"max-width\", \"300px\"], [1, \"information\"], [1, \"heading\"], [\"class\", \"item\", 4, \"ngFor\", \"ngForOf\"], [1, \"total\"], [1, \"mt30\"], [1, \"btn\", \"btn-primary\", \"btn-white\", \"page-scroll\", 2, \"margin-right\", \"10%\", 3, \"click\"], [1, \"thin-hr\"], [1, \"item\"]],\n    template: function ClientInvoiceComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 1)(2, \"div\", 2)(3, \"div\", 3)(4, \"table\", 4)(5, \"tr\", 5)(6, \"td\", 6)(7, \"table\")(8, \"tr\")(9, \"td\", 7);\n        i0.ɵɵelement(10, \"img\", 8);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(11, \"td\");\n        i0.ɵɵtext(12);\n        i0.ɵɵpipe(13, \"date\");\n        i0.ɵɵelement(14, \"br\");\n        i0.ɵɵelementEnd()()()()();\n        i0.ɵɵelementStart(15, \"tr\", 9)(16, \"td\", 6)(17, \"table\")(18, \"tr\");\n        i0.ɵɵelement(19, \"td\");\n        i0.ɵɵelementStart(20, \"td\");\n        i0.ɵɵelement(21, \"br\");\n        i0.ɵɵelementEnd()()()()();\n        i0.ɵɵelementStart(22, \"tr\", 10)(23, \"td\");\n        i0.ɵɵtext(24, \" Events \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(25, \"td\");\n        i0.ɵɵtext(26, \" Price \");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵtemplate(27, ClientInvoiceComponent_tr_27_Template, 5, 2, \"tr\", 11);\n        i0.ɵɵelementStart(28, \"tr\", 12);\n        i0.ɵɵelement(29, \"td\");\n        i0.ɵɵelementStart(30, \"td\");\n        i0.ɵɵtext(31);\n        i0.ɵɵelementEnd()()()()()()();\n        i0.ɵɵelementStart(32, \"div\", 0)(33, \"div\", 1)(34, \"div\", 2)(35, \"p\", 13)(36, \"a\", 14);\n        i0.ɵɵlistener(\"click\", function ClientInvoiceComponent_Template_a_click_36_listener() {\n          return ctx.DownloadPDF();\n        });\n        i0.ɵɵtext(37, \"Download\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelement(38, \"hr\", 15);\n        i0.ɵɵelementEnd()()();\n      }\n\n      if (rf & 2) {\n        i0.ɵɵadvance(12);\n        i0.ɵɵtextInterpolate1(\" \", i0.ɵɵpipeBind2(13, 3, ctx.today, \"fullDate\"), \"\");\n        i0.ɵɵadvance(15);\n        i0.ɵɵproperty(\"ngForOf\", ctx.reserved);\n        i0.ɵɵadvance(4);\n        i0.ɵɵtextInterpolate1(\" Total=\", ctx.totale, \" \");\n      }\n    },\n    styles: [\".invoice-box[_ngcontent-%COMP%]{max-width:800px;margin:auto;padding:30px;border:1px solid #eee;box-shadow:0 0 10px #00000026;font-size:16px;line-height:24px;font-family:Helvetica Neue,Helvetica,Helvetica,Arial,sans-serif;color:#555}.invoice-box[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{width:100%;line-height:inherit;text-align:left}.invoice-box[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:5px;vertical-align:top}.invoice-box[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:nth-child(2){text-align:right}.invoice-box[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tr.top[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding-bottom:20px}.invoice-box[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tr.top[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td.title[_ngcontent-%COMP%]{font-size:45px;line-height:45px;color:#333}.invoice-box[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tr.information[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding-bottom:40px}.invoice-box[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tr.heading[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{background:#eee;border-bottom:1px solid #ddd;font-weight:700}.invoice-box[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tr.details[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding-bottom:20px}.invoice-box[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tr.item[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{border-bottom:1px solid #eee}.invoice-box[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tr.item.last[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{border-bottom:none}.invoice-box[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tr.total[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:nth-child(2){border-top:2px solid #eee;font-weight:700}@media only screen and (max-width: 600px){.invoice-box[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tr.top[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%], .invoice-box[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tr.information[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{width:100%;display:block;text-align:center}}.rtl[_ngcontent-%COMP%]{direction:rtl;font-family:Tahoma,Helvetica Neue,Helvetica,Helvetica,Arial,sans-serif}.rtl[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{text-align:right}.rtl[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:nth-child(2){text-align:left}\"]\n  });\n  return ClientInvoiceComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}